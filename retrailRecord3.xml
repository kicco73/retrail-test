<?xml version="1.0" encoding="UTF-8"?>
<retrailRecorder>
    <record ms="3540">
        <methodCall xmlns:ex="http://ws.apache.org/xmlrpc/namespaces/extensions">
            <methodName>UCon.tryAccess</methodName>
            <params>
                <param>
                    <value>
                        <ex:dom>
                            <Request xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" ReturnPolicyIdList="false" CombinedDecision="false">
                                <Attributes Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource">
                                    <Attribute Issuer="issuer" IncludeInResult="false" AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id">
                                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string"/>
                                    </Attribute>
                                </Attributes>
                                <Attributes Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject">
                                    <Attribute Issuer="issuer" IncludeInResult="false" AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id">
                                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Carniani</AttributeValue>
                                    </Attribute>
                                </Attributes>
                                <Attributes Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action">
                                    <Attribute Issuer="issuer" IncludeInResult="false" AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id">
                                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">urn:fedora:names:fedora:2.1:action:id-getDatastreamDissemination</AttributeValue>
                                    </Attribute>
                                </Attributes>
                            </Request>
                        </ex:dom>
                    </value>
                </param>
                <param>
                    <value>http://localhost:8081</value>
                </param>
                <param>
                    <value>Carniani</value>
                </param>
            </params>
        </methodCall>
        <methodResponse xmlns:ex="http://ws.apache.org/xmlrpc/namespaces/extensions">
            <params>
                <param>
                    <value>
                        <ex:dom>
                            <Response>
                                <Result>
                                    <Decision>Permit</Decision>
                                    <Status>
                                        <StatusCode Value="urn:oasis:names:tc:xacml:1.0:status:ok"/>
                                    </Status>
                                    <Obligations>
                                        <Obligation ObligationId="sayWelcome"/>
                                        <Obligation ObligationId="showUser"/>
                                    </Obligations>
                                </Result>
                                <Session uuid="2C842618-DBBA-46BF-85F1-4FB1043A63C5" uconUrl="http://146.48.99.121:8080" status="TRY" customId="Carniani"/>
                            </Response>
                        </ex:dom>
                    </value>
                </param>
            </params>
        </methodResponse>
    </record>
    <record ms="8123">
        <methodCall xmlns:ex="http://ws.apache.org/xmlrpc/namespaces/extensions">
            <methodName>UCon.startAccess</methodName>
            <params>
                <param>
                    <value>2C842618-DBBA-46BF-85F1-4FB1043A63C5</value>
                </param>
                <param>
                    <value>Carniani</value>
                </param>
            </params>
        </methodCall>
        <methodResponse xmlns:ex="http://ws.apache.org/xmlrpc/namespaces/extensions">
            <params>
                <param>
                    <value>
                        <ex:dom>
                            <Response>
                                <Result>
                                    <Decision>Permit</Decision>
                                    <Status>
                                        <StatusCode Value="urn:oasis:names:tc:xacml:1.0:status:ok"/>
                                    </Status>
                                    <Obligations>
                                        <Obligation ObligationId="sayDetected"/>
                                        <Obligation ObligationId="hideUser"/>
                                    </Obligations>
                                </Result>
                                <Session uuid="2C842618-DBBA-46BF-85F1-4FB1043A63C5" uconUrl="http://146.48.99.121:8080" status="ONGOING" customId="Carniani"/>
                            </Response>
                        </ex:dom>
                    </value>
                </param>
            </params>
        </methodResponse>
    </record>
    <record ms="11714">
        <methodCall xmlns:ex="http://ws.apache.org/xmlrpc/namespaces/extensions">
            <methodName>UCon.heartbeat</methodName>
            <params>
                <param>
                    <value>http://localhost:8081</value>
                </param>
                <param>
                    <value>
                        <array>
                            <data>
                                <value>2C842618-DBBA-46BF-85F1-4FB1043A63C5</value>
                            </data>
                        </array>
                    </value>
                </param>
            </params>
        </methodCall>
        <methodResponse xmlns:ex="http://ws.apache.org/xmlrpc/namespaces/extensions">
            <params>
                <param>
                    <value>
                        <ex:dom>
                            <Heartbeat>
                                <Responses/>
                                <Config watchdogPeriod="15" maxMissedHeartbeats="1"/>
                            </Heartbeat>
                        </ex:dom>
                    </value>
                </param>
            </params>
        </methodResponse>
    </record>
    <record ms="22795">
        <methodCall xmlns:ex="http://ws.apache.org/xmlrpc/namespaces/extensions">
            <methodName>UCon.endAccess</methodName>
            <params>
                <param>
                    <value>2C842618-DBBA-46BF-85F1-4FB1043A63C5</value>
                </param>
                <param>
                    <value>Carniani</value>
                </param>
            </params>
        </methodCall>
        <methodResponse xmlns:ex="http://ws.apache.org/xmlrpc/namespaces/extensions">
            <params>
                <param>
                    <value>
                        <ex:dom>
                            <Response>
                                <Result>
                                    <Decision>Permit</Decision>
                                    <StatusMessage/>
                                </Result>
                                <Session uuid="2C842618-DBBA-46BF-85F1-4FB1043A63C5" uconUrl="http://146.48.99.121:8080" status="DELETED" customId="Carniani"/>
                            </Response>
                        </ex:dom>
                    </value>
                </param>
            </params>
        </methodResponse>
    </record>
</retrailRecorder>